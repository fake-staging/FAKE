<!DOCTYPE html>
<html lang="en" class="has-navbar-fixed-top">

<head>
	<title>Deployment using FAKE
</title>
	<meta charset="utf-8" />

	<!-- from https://realfavicongenerator.net -->
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#2d89ef">
	<meta name="theme-color" content="#ffffff">


	<meta name="author" content="Steffen Forkmann, Mauricio Scheffer, Colin Bull, Matthias Dittrich" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
	 crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.css">
	<link rel="stylesheet" href="/assets/css/bulmaswatch.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/toolbar/prism-toolbar.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/line-numbers/prism-line-numbers.css">
	<link rel="stylesheet" href="/assets/css/style.css">
</head>

<body>
	<nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation">
		<div class="navbar-brand">
			<a class="navbar-item no-hover" href="/">
				<img src="/assets/img/logo.svg" alt="FAKE - F# Make - A DSL for build tasks and more" width="28" height="28">
				<span class="p-l-sm">FAKE</span>
			</a>

			<a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar">
				<span aria-hidden="true"></span>
				<span aria-hidden="true"></span>
				<span aria-hidden="true"></span>
			</a>
		</div>

		<div id="navbar" class="navbar-menu">
			<div class="navbar-start">
				<div class="navbar-item has-dropdown is-hoverable">
					<a class="navbar-link">Tutorials</a>
					<div class="navbar-dropdown">
						<a href="/fake-gettingstarted.html" class="navbar-item">Getting started</a>
						<a href="/fake-commandline.html" class="navbar-item">Running FAKE from command line</a>
						<a href="/fake-template.html" class="navbar-item">FAKE template</a>
						<a href="/fake-debugging.html" class="navbar-item">Debugging scripts</a>
                        <a href="/fake-completion.html" class="navbar-item">FAKE command-line completion</a>
					</div>
				</div>

				<div class="navbar-item has-dropdown is-hoverable">
					<a class="navbar-link">About</a>
					<div class="navbar-dropdown" class="navbar-item">
						<a href="/help-users.html" class="navbar-item">Who is using FAKE?</a>
						<a href="/help-supporters.html" class="navbar-item">Supporters</a>
						<a href="https://www.nuget.org/packages/FAKE" class="navbar-item">NuGet</a>
						<a href="https://chocolatey.org/packages/fake" class="navbar-item">Chocolatey</a>
						<a href="https://github.com/fsharp/FAKE/blob/master/License.txt" class="navbar-item">License</a>
						<a href="/RELEASE_NOTES.html" class="navbar-item">Release Notes</a>
						<a href="/contributing.html" class="navbar-item">Contributing</a>
						<a href="https://github.com/fsharp/FAKE/issues/new" class="navbar-item">Ask a question or
							report a bug</a>
					</div>
				</div>

				<div class="navbar-item has-dropdown is-hoverable">
					<a href="/fake-fake5-modules.html" class="navbar-link">Modules</a>
					<div class="navbar-dropdown" class="navbar-item">
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Api" class="navbar-link">API</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/api-slack.html" class="navbar-item">Slack</a>
								<a href="/apidocs/v5/fake-api-github.html" class="navbar-item">GitHub</a>
								<a href="/apidocs/v5/fake-api-hockeyapp.html" class="navbar-item">HockeyApp</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Azure" class="navbar-link">Azure</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-azure-cloudservices.html" class="navbar-item">CloudServices</a>
								<a href="/apidocs/v5/fake-azure-emulators.html" class="navbar-item">Emulators</a>
								<a href="/apidocs/v5/fake-azure-kudu.html" class="navbar-item">Kudu</a>
								<a href="/apidocs/v5/fake-azure-webjobs.html" class="navbar-item">WebJobs</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/buildserver.html" class="navbar-link">BuildServer</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/index.html#Fake.BuildServer" class="navbar-item">Api-Reference</a>
								<a href="/apidocs/v5/fake-buildserver-appveyor.html" class="navbar-item">AppVeyor</a>
								<a href="/apidocs/v5/fake-buildserver-teamfoundation.html" class="navbar-item">Azure
									DevOps</a>
								<a href="/apidocs/v5/fake-buildserver-gitlab.html" class="navbar-item">GitLab</a>
								<a href="/apidocs/v5/fake-buildserver-teamcity.html" class="navbar-item">TeamCity</a>
								<a href="/apidocs/v5/fake-buildserver-travis.html" class="navbar-item">Travis</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/core.html" class="navbar-link">Core</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-core-buildserver.html" class="navbar-item">BuildServer</a>
								<a href="/apidocs/v5/fake-core-changelog.html" class="navbar-item">ChangeLog</a>
								<a href="/core-commandlineparsing.html" class="navbar-item">CommandLineParsing</a>
								<a href="/apidocs/v5/fake-core-context.html" class="navbar-item">Context</a>
								<a href="/apidocs/v5/fake-core-environment.html" class="navbar-item">Environment</a>
								<a href="/core-process.html" class="navbar-item">Process</a>
								<a href="/apidocs/v5/fake-core-releasenotes.html" class="navbar-item">ReleaseNotes</a>
								<a href="/apidocs/v5/fake-core-semver.html" class="navbar-item">SemVer</a>
								<a href="/apidocs/v5/fake-core-string.html" class="navbar-item">String</a>
								<a href="/core-targets.html" class="navbar-item">Targets</a>
								<a href="/apidocs/v5/fake-core-taskrunner.html" class="navbar-item">Tasks</a>
								<a href="/core-trace.html" class="navbar-item">Trace</a>
								<a href="/apidocs/v5/fake-core-userinput.html" class="navbar-item">UserInput</a>
								<a href="/core-vault.html" class="navbar-item">Vault</a>
								<a href="/apidocs/v5/fake-core-xml.html" class="navbar-item">Xml</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Documentation" class="navbar-link">Documentation</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-documentation-docfx.html" class="navbar-item">DocFx</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.DotNet" class="navbar-link">DotNet</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/dotnet-cli.html" class="navbar-item">Cli</a>
								<a href="/dotnet-assemblyinfo.html" class="navbar-item">AssemblyInfoFile</a>
								<a href="/apidocs/v5/fake-dotnet-fsc.html" class="navbar-item">Fsc</a>
								<a href="/apidocs/v5/fake-dotnet-fsi.html" class="navbar-item">Fsi</a>
								<a href="/apidocs/v5/fake-dotnet-fxcop.html" class="navbar-item">FxCop</a>
								<a href="/apidocs/v5/fake-dotnet-msbuild.html" class="navbar-item">MSBuild</a>
								<a href="/apidocs/v5/fake-dotnet-ilmerge.html" class="navbar-item">ILMerge</a>
								<a href="/apidocs/v5/fake-dotnet-testing-nunit3.html" class="navbar-item">Testing -
									NUnit</a>
								<a href="/apidocs/v5/fake-dotnet-testing-mspec.html" class="navbar-item">Testing -
									MSpec</a>
								<a href="/apidocs/v5/fake-dotnet-testing-xunit2.html" class="navbar-item">Testing -
									XUnit2</a>
								<a href="/apidocs/v5/fake-dotnet-testing-expecto.html" class="navbar-item">Testing -
									Expecto</a>
								<a href="/apidocs/v5/fake-dotnet-testing-vstest.html" class="navbar-item">Testing -
									VSTest</a>
								<a href="/fake-dotnet-testing-specflow.html" class="navbar-item">Testing - SpecFlow</a>
								<a href="/dotnet-testing-opencover.html" class="navbar-item">Testing - OpenCover</a>
								<a href="/apidocs/v5/fake-dotnet-testing-dotcover.html" class="navbar-item">Testing -
									DotCover</a>
								<a href="/dotnet-nuget.html" class="navbar-item">NuGet</a>
								<a href="/apidocs/v5/fake-dotnet-mage.html" class="navbar-item">Mage</a>
								<a href="/apidocs/v5/fake-dotnet-paket.html" class="navbar-item">Paket</a>
								<a href="/apidocs/v5/fake-dotnet-xdt.html" class="navbar-item">XML Transforms</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/core-targets.html" class="navbar-link">DSL</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="https://github.com/vbfox/FoxSharp/blob/master/src/BlackFox.Fake.BuildTask/Readme.md" class="navbar-item">BlackFox.Fake.BuildTask</a>
								<a href="https://github.com/xakebuild/Xake" class="navbar-item">Xake</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/index.html#Fake.Installer" class="navbar-link">Installer</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-installer-innosetup.html" class="navbar-item">InnoSetup</a>
								<a href="/fake-installer-squirrel.html" class="navbar-item">Squirrel</a>
								<a href="/apidocs/v5/fake-installer-wix.html" class="navbar-item">Wix</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/index.html#Fake.IO" class="navbar-link">IO</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/index.html#Fake.IO" class="navbar-item">FileSystem</a>
								<a href="/apidocs/v5/fake-io-changewatcher.html" class="navbar-item">Change Watcher</a>
								<a href="/apidocs/v5/fake-io-globbing-operators.html" class="navbar-item">Globbing</a>
								<a href="/apidocs/v5/fake-io-zip.html#Functions and values" class="navbar-item">Zip</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.JavaScript" class="navbar-link">JavaScript</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-javascript-npm.html" class="navbar-item">Npm</a>
								<a href="/apidocs/v5/fake-javascript-yarn.html" class="navbar-item">Yarn</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Net" class="navbar-link">Net</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/net-http.html" class="navbar-item">Http</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Sql" class="navbar-link">Sql</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/sql-dacpac.html" class="navbar-item">DacPac</a>
								<a href="/sql-sqlserver.html" class="navbar-item">SQL Server</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Testing" class="navbar-link">Testing</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/testing-sonarqube.html" class="navbar-item">SonarQube</a>
								<a href="/testing-reportgenerator.html" class="navbar-item">ReportGenerator</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Tools" class="navbar-link">Tools</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/index.html#Fake.Tools.Git" class="navbar-item">Git</a>
								<a href="/fake-tools-pickles.html" class="navbar-item">Pickles</a>
								<a href="/fake-tools-octo.html" class="navbar-item">Octo</a>
								<a href="/apidocs/v5/fake-tools-rsync.html" class="navbar-item">Rsync</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/index.html#Fake.Windows" class="navbar-link">Windows</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/windows-chocolatey.html" class="navbar-item">Chocolatey</a>
							</div>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/apidocs/v5/fake-windows-registry.html" class="navbar-item">Registry</a>
							</div>
						</div>
						<div class="navbar-item has-dropdown is-hoverable">
							<a href="/apidocs/v5/legacy/index.html#Fake" class="navbar-link">Legacy / Not Migrated</a>
							<div class="navbar-dropdown" class="navbar-item">
								<a href="/todo-fluentmigrator.html" class="navbar-item">?.?.FluentMigrator</a>
								<a href="/todo-androidpublisher.html" class="navbar-item">?.?.AndroidPublisher</a>
								<a href="/todo-wix.html" class="navbar-item">Windows.WiX</a>
								<a href="/todo-msteamsnotification.html" class="navbar-item">API.MsTeams</a>
								<a href="/todo-stylecop.html" class="navbar-item">DotNet.StyleCop</a>
								<a href="/todo-deploy.html" class="navbar-item">Fake.Deploy</a>
								<a href="/todo-iis.html" class="navbar-item">?.?.IIS</a>
								<a href="/todo-vagrant.html" class="navbar-item">?.?.Vagrant</a>
								<a href="/todo-fxcop.html" class="navbar-item">DotNet.FxCop</a>
								<a href="/todo-canopy.html" class="navbar-item">DotNet.Testing.Canopy</a>
								<a href="/todo-octopusdeploy.html" class="navbar-item">?.?.OctopusDeploy</a>
								<a href="/todo-typescript.html" class="navbar-item">JavaScript?.TypeScript</a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="navbar-end">
				<div class="navbar-item has-dropdown is-hoverable">
					<a href="/apidocs/v5/index.html" class="navbar-link">API Reference</a>
					<div class="navbar-dropdown is-right">
						<a href="/apidocs/v5/index.html" class="navbar-item">FAKE 5 API Reference</a>
						<a href="/apidocs/v5/legacy/index.html" class="navbar-item">FAKE 5 Migration API</a>
						<a href="/apidocs/v4/index.html" class="navbar-item">FAKE 4 API Reference</a>
					</div>
				</div>

				<div class="navbar-item has-dropdown is-hoverable">
					<a class="navbar-link">FAKE 4</a>
					<div class="navbar-dropdown is-right">
						<a href="/fake-migrate-to-fake-5.html" class="navbar-item">FAKE migration</a>
						<a href="/legacy-gettingstarted.html" class="navbar-item">Getting started</a>
						<a href="/help-docs.html" class="navbar-item">Where is XYZ???</a>
						<a href="/legacy-commandline.html" class="navbar-item">Running FAKE from command line</a>
						<a href="/legacy-core-targets.html" class="navbar-item">Targets</a>
						<a href="/fake-cache.html" class="navbar-item">Build script caching</a>
					</div>
				</div>
				<div class="navbar-item no-hover">
					<div class="buttons">
						<a href="https://github.com/fsharp/FAKE" class="m-r-sm">
							<i class="fab fa-github fa-lg fa-fw"></i>
						</a>
						<a href="https://twitter.com/fsharpMake" class="m-r-sm">
							<i class="fab fa-twitter fa-lg fa-fw"></i>
						</a>
						<a href="https://fsharp.slack.com/" class="m-r-sm">
							<i class="fab fa-slack fa-lg fa-fw"></i>
						</a>
					</div>
				</div>
			</div>
		</div>
	</nav>

	

<section id="content" class="section">
	<div class="columns">
		<div class="column is-9-desktop is-12-mobile">
			<article class="content">
				<h1><a name="Deployment-using-FAKE" class="anchor" href="#Deployment-using-FAKE">Deployment using FAKE</a></h1>
<div class="alert alert-info">
    <h5>INFO</h5>
    <p>Fake.Deploy is no longer part of FAKE 5 and is considered obsolete and fully replaced by modern deployment systems (puppet, chef, PowerShell DSC, ...). <a href"https://github.com/fsharp/FAKE/issues/1820">Announcement</a>
    You can still use fake scripts on those alternative deployment systems. Just download the fake binaries and run your scripts.</p>
</div>
<p>This introduction assumes Fake.Deploy.exe is available in the current directory or path.</p>
<h2><a name="Introduction" class="anchor" href="#Introduction">Introduction</a></h2>
<p>The FAKE deployment tool allows users to deploy applications to remote computers and to run scripts on these remote agents. A typical scenario maybe as follows:</p>
<ul>
<li>Build an application -&gt; run tests -&gt; create artifacts and save on build server (Classical FAKE build workflow)</li>
<li>Extract artifacts from build server and create a NuGet deployment package</li>
<li>Push the NuGet package to the desired computer this will run the package's FAKE script on the remote machine</li>
</ul>
<h2><a name="Installing-Fake-deployment-services" class="anchor" href="#Installing-Fake-deployment-services">Installing Fake deployment services</a></h2>
<p>In order to deploy application to a remote computer a deployment agent needs to be running on that server.</p>
<p>The simplest way to install the agent on a remote server is to use the <a href="http://docs.nuget.org/consume/installing-nuget">Nuget command line tool</a> to download the FAKE nuget and extract the binaries into a <em>fake/tools</em> subfolder.  Once  <em>nuget.exe</em> is available on the path, use the following command in a command shell:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="batchfile">nuGet.exe Install FAKE -ExcludeVersion
</code></pre></td></tr></table>
<p>Adding the <em>.../fake/tools</em> folder to the path will simplify executing the Fake.Deploy.exe.</p>
<p>To run an agent in a console, simply run:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Fake</span><span class="pn">.</span><span class="id">Deploy</span>
</code></pre></td>
</tr>
</table>
<p>To install a windows service on that agent:</p>
<ul>
<li>Open a command prompt with Administrator Privilege</li>
<li>Run Fake.Deploy /install</li>
</ul>
<p>By default the service starts a listener on port 8080. This can however be configured by editing the Fake.Deploy.exe.config file
and changing</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="pn">&lt;</span><span class="id">add</span> <span class="id">key</span><span class="o">=</span><span class="s">&quot;ServerName&quot;</span> <span class="id">value</span><span class="o">=</span><span class="s">&quot;localhost&quot;</span> <span class="o">/&gt;</span>
<span class="pn">&lt;</span><span class="id">add</span> <span class="id">key</span><span class="o">=</span><span class="s">&quot;Port&quot;</span> <span class="id">value</span><span class="o">=</span><span class="s">&quot;8080&quot;</span> <span class="o">/&gt;</span>
</code></pre></td>
</tr>
</table>
<p>to the desired value. If you use the asterisk as port no. then Fake.Deploy will assign the first open port behind of 8080.</p>
<p>To ensure the service is running you can navigate to <a href="http://{computer}:{port}/fake/">http://{computer}:{port}/fake/</a> and you should be presented with a page giving the
status if the service</p>
<h2><a name="Uninstalling-Fake-deployment-services" class="anchor" href="#Uninstalling-Fake-deployment-services">Uninstalling Fake deployment services</a></h2>
<p>To uninstall an agent</p>
<ul>
<li>Open a command prompt with Administrator Privilege</li>
<li>Run Fake.Deploy /uninstall</li>
</ul>
<h2><a name="Running-a-FAKE-Deployment-Package" class="anchor" href="#Running-a-FAKE-Deployment-Package">Running a FAKE Deployment Package</a></h2>
<h2><a name="Getting-help" class="anchor" href="#Getting-help">Getting help</a></h2>
<p>If you want to learn about Fake.Deploy's command line switches then run:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Fake</span><span class="pn">.</span><span class="id">Deploy</span> <span class="o">/</span><span class="id">help</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Creating-a-Deployment-package" class="anchor" href="#Creating-a-Deployment-package">Creating a Deployment package</a></h2>
<p>Since Fake.Deploy uses Nuget packages for deployment you only need to create one of those and include a .fsx file in the root folder of the package.</p>
<p>Instructions for creating nuget packages can be found <a href="http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package">at the NuGet document page</a></p>
<h2><a name="Running-deployment" class="anchor" href="#Running-deployment">Running deployment</a></h2>
<p>Fake deployment packages can be run manually on the current machine or they can be pushed to an agent on a remote machine.</p>
<p>To run a package on the local machine located at C:\Appdev\MyDeployment.nupkg you would run the following command:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Fake</span><span class="pn">.</span><span class="id">Deploy</span> <span class="o">/</span><span class="id">deploy</span> <span class="id">C</span><span class="pn">:</span><span class="o">/</span><span class="id">Appdev</span><span class="o">/</span><span class="id">MyDeployment</span><span class="pn">.</span><span class="id">nupkg</span>
</code></pre></td>
</tr>
</table>
<p>To run the same package on a remote computer (e.g. integration-1) you can run:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Fake</span><span class="pn">.</span><span class="id">Deploy</span> <span class="o">/</span><span class="id">deployRemote</span> <span class="id">http</span><span class="pn">:</span><span class="c">//integration-1:8080/fake C:/Appdev/MyDeployment.nupkg</span>
</code></pre></td>
</tr>
</table>
<p>It's also possible to just make a HTTP-POST with the package to <a href="http://integration-1:8080/fake">http://integration-1:8080/fake</a></p>
<p>This will push the directory to the given url. It is worth noting that the port may well be different, as this depends on the configuration of the
listening agent (see. Installing Fake deployment service)</p>
<h2><a name="Getting-information-about-the-deployments" class="anchor" href="#Getting-information-about-the-deployments">Getting information about the deployments</a></h2>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">The</span> <span class="id">following</span> <span class="id">assumes</span> <span class="id">you</span> <span class="id">have</span> <span class="id">Fake</span><span class="pn">.</span><span class="id">Deploy</span> <span class="id">running</span><span class="pn">.</span>
</code></pre></td>
</tr>
</table>
<p>It's easy to get information about the deployments. Just make a HTTP request to server with:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">/</span>                     <span class="k">-&gt;</span> <span class="id">gives</span> <span class="id">all</span> <span class="id">releases</span>
<span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">?</span><span class="id">status</span><span class="o">=</span><span class="id">active</span>        <span class="k">-&gt;</span> <span class="id">gives</span> <span class="id">all</span> <span class="id">active</span> <span class="id">releases</span>
<span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">/</span><span class="pn">{</span><span class="id">app</span><span class="pn">}</span>                <span class="k">-&gt;</span> <span class="id">gives</span> <span class="id">all</span> <span class="id">releases</span> <span class="k">of</span> <span class="id">app</span>
<span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">/</span><span class="pn">{</span><span class="id">app</span><span class="pn">}</span><span class="o">?</span><span class="id">status</span><span class="o">=</span><span class="id">active</span>  <span class="k">-&gt;</span> <span class="id">gives</span> <span class="id">the</span> <span class="id">active</span> <span class="id">release</span> <span class="k">of</span> <span class="id">the</span> <span class="id">app</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Rollback-of-releases" class="anchor" href="#Rollback-of-releases">Rollback of releases</a></h2>
<p>If you want to perform a rollback of a release so do a HTTP-PUT to:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">/</span><span class="pn">{</span><span class="id">app</span><span class="pn">}</span><span class="o">?</span><span class="id">version</span><span class="o">=</span><span class="pn">{</span><span class="id">version</span><span class="pn">}</span> <span class="k">-&gt;</span> <span class="id">rolls</span> <span class="id">the</span> <span class="id">app</span> <span class="id">back</span> <span class="k">to</span> <span class="id">the</span> <span class="id">given</span> <span class="id">version</span>
<span class="id">fake</span><span class="o">/</span><span class="id">deployments</span><span class="o">/</span><span class="pn">{</span><span class="id">app</span><span class="pn">}</span><span class="o">?</span><span class="id">version</span><span class="o">=</span><span class="id">HEAD</span><span class="k">~</span><span class="n">2</span>    <span class="k">-&gt;</span> <span class="id">relative</span> <span class="id">rollback</span> <span class="k">of</span> <span class="id">the</span> <span class="id">app</span> <span class="pn">(</span><span class="id">two</span> <span class="id">versions</span> <span class="id">earlier</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Security" class="anchor" href="#Security">Security</a></h2>
<p>To turn on authentication in Fake.Deploy set the configuration value for 'Authorization' to 'On' (default is 'Off') in fake.deploy.config.
When you set this value to 'On' you must also set the configuration key 'AuthorizedKeysFile' to point to a file that that contains the mapping between keys and usernames.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="pn">&lt;</span><span class="id">add</span> <span class="id">key</span><span class="o">=</span><span class="s">&quot;Authorization&quot;</span> <span class="id">value</span><span class="o">=</span><span class="s">&quot;On&quot;</span> <span class="o">/&gt;</span>
<span class="pn">&lt;</span><span class="id">add</span> <span class="id">key</span><span class="o">=</span><span class="s">&quot;AuthorizedKeysFile&quot;</span> <span class="id">value</span><span class="o">=</span><span class="s">&quot;c:\fake_deploy\authorized_keys&quot;</span> <span class="o">/&gt;</span>
</code></pre></td>
</tr>
</table>
<p>If you deploy from a fake buildscript you need to make a call to <code>FakeDeployAgentHelper.authenticate</code> before you perfrom any other call to the agent.
<code>authenticate</code> takes 4 parameters, <code>server</code>, <code>userId</code>, <code>pathToPrivateKey</code> and the <code>password</code> for the private key</p>
<h3><a name="AuthorizedKeysFile" class="anchor" href="#AuthorizedKeysFile">AuthorizedKeysFile</a></h3>
<p>Is a rsa-pub key file where each line represents one user.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">ssh</span><span class="o">-</span><span class="id">rsa</span> <span class="id">AAAAB3NzaC1yc2EAAAABJ_some_parts_removed_E91p</span><span class="o">+</span><span class="n">8JLFCaF3tLc8Aw</span><span class="o">==</span> <span class="id">Test</span><span class="id">@</span><span class="id">Fake</span><span class="pn">.</span><span class="id">org</span>
</code></pre></td>
</tr>
</table>
<p>Each row has 3 values separated by space</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="pn">*</span> <span class="id">which</span> <span class="k">type</span> <span class="k">of</span> <span class="id">key</span> <span class="id">it</span> <span class="id">is</span><span class="pn">,</span> <span class="id">it</span> <span class="id">must</span> <span class="id">be</span> <span class="id">&#39;</span><span class="id">ssh</span><span class="o">-</span><span class="id">rsa&#39;</span>
<span class="pn">*</span> <span class="k">public</span> <span class="id">key</span> <span class="k">in</span> <span class="id">base64</span> <span class="id">format</span>
<span class="pn">*</span> <span class="id">username</span> <span class="id">the</span> <span class="id">key</span> <span class="id">maps</span> <span class="k">to</span><span class="pn">.</span>
</code></pre></td>
</tr>
</table>
<h3><a name="How-to-authorize-against-Fake-Deploy" class="anchor" href="#How-to-authorize-against-Fake-Deploy">How to authorize against Fake.Deploy</a></h3>
<p>First you must perform a HTTP-GET to:
fake/login/yourUserId</p>
<p>From the response from this request, you take the body and base64 decode it, then you sign that value with your private key.
Then you submit a HTTP-POST to
/fake/login.
There are 2 values you need to supply in the HTTP-POST.</p>
<ol>
<li><code>challenge</code> which should have the same base64 encoded value you received in the body of get fake/login/userId.</li>
<li><code>signature</code> which should contain the signature you created using the <code>challenge</code> value and your private key.</li>
</ol>
<p>The body of the response from the HTTP-POST contains a guid, this guid should be passed in the header with the name <code>AuthToken</code>.
To logout make a HTTP-GET to:
fake/logout</p>
<h3><a name="How-do-I-generate-a-key-on-Windows" class="anchor" href="#How-do-I-generate-a-key-on-Windows">How do I generate a key on Windows?</a></h3>
<p>Get <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTYgen</a>.
Run it.
Make sure the key is 'SSH-2 RSA' and number of bits is (at least) 2048.
Click <code>Generate</code> and follow the instructions to genereate the key.
When the key is generated, change <code>Key comment</code> to be your username and set a passphrase.
Then save the public key, you need to put this into Fake.Deploy's authorized keys file.
To save the private key, click <code>Conversions</code> menu option and then click <code>Export OpenSSH key</code></p>
<h3><a name="Linux" class="anchor" href="#Linux">Linux</a></h3>
<p>ssh-keygen -t rsa -b 2048 -N password</p>

				
			</article>
		</div>

		<aside class="menu column is-3 is-hidden-touch">
			<ul class="menu-list"></ul>
		</aside>
	</div>
</section>

	<footer>
		<div class="hero is-dark">
			<div class="hero-body">
				<div class="container">
					<div class="columns">
						<div class="column is-6">
							<div class="columns">
								<div class="column is-6">
									<h4 class="title is-4">Important links</h4>
									<ul class="has-text-grey-light">
										<li><a href="/fake-gettingstarted.html">Getting started</a></li>
										<li><a href="/fake-fake5-modules.html">Modules</a></li>
										<li><a href="/fake-fake5-modules.html#Declaring-FAKE-5-dependencies-within-the-script">FAKE Header</a></li>
									</ul>
								</div>
								<div class="column is-6">
									<h4 class="title is-4">Further projects</h4>
									<ul class="has-text-grey-light">
										<li><a href="https://fsprojects.github.io/Paket/">Paket</a></li>
										<li><a href="https://fsprojects.github.io/FSharp.Formatting/">FSharp Formatting</a></li>
										<li><a href="http://fsharp.org/">F#</a></li>
										<li><a href="http://ionide.io/">Ionide</a></li>
										<li><a href="http://forge.run/">Forge</a></li>
										<li><a href="https://fsharp.github.io/FSharp.Compiler.Service/">FSharp.Compiler.Service</a></li>
									</ul>
								</div>
							</div>
							<div class="p-t-lg has-text-grey-light">© FAKE. All rights reserved | Page generated with Version: <a href="https://github.com/fsharp/FAKE/releases">5.13.2</a></div>
						</div>
						<div class="column is-6">
							<h4 class="title is-4">FAKE is a community effort</h4>
							<p>Please help with the development of FAKE, a free, fully open source DSL and Runtime for
								running F# scripts. Look at the open issues at <a href="https://github.com/fsharp/FAKE/issues">GitHub</a>,
								discuss new features, fix bugs and
								send pull requests!</p>
							<a href="/contributing.html" class="button is-light is-medium m-t-md">Learn more</a>

							<h4 class="title is-4 m-t-lg">Get in touch</h4>

							<div class="footer-contact">
								<div class="columns">
									<div class="column is-2">Twitter</div>
									<div class="column is-6"><a href="https://twitter.com/fsharpMake">@fsharpMake</a></div>
								</div>
								<div class="columns">
									<div class="column is-2">WWW</div>
									<div class="column is-6"><a href="https://fake.build">fake.build</a></div>
								</div>
								<div class="columns">
									<div class="column is-2">GitHub</div>
									<div class="column is-6"><a href="https://github.com/fsharp/FAKE">GitHub</a></div>
								</div>
								<div class="columns">
									<div class="column is-2">F# Slack</div>
									<div class="column is-6"><a href="https://fsharp.slack.com/">Slack</a></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-fsharp.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-batch.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/toolbar/prism-toolbar.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/line-numbers/prism-line-numbers.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
	<script src="/assets/js/tips.js" type="text/javascript"></script>
	<script src="/assets/js/bulma.js"></script>
</body>

</html>
