<!DOCTYPE HTML>

<html>
	<head>
		<title>Create WiX Setup
</title>
		<meta charset="utf-8" />
		<meta name="author" content="Steffen Forkmann, Mauricio Scheffer, Colin Bull, Matthias Dittrich" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link type="text/css" rel="stylesheet" href="/assets/css/style.css">
		<!--<link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"> -->
		<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-tomorrow.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/Primer/10.5.0/build.css" rel="stylesheet">
		<link rel="stylesheet" href="/assets/css/iconmonstr-iconic-font.css" />
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
	</head>
	<body class="no-sidebar">
		<div id="page-wrapper">


			<!-- Header Wrapper -->
				<div id="header-wrapper">
					<div class="container">
						<!-- Header -->
							<header id="header">
								<div class="inner">

									<!-- Logo -->
										<h1><a href="/index.html" id="logo">FAKE 5</a></h1>

									<!-- Nav -->
										<nav id="nav">
											<ul>
												<li >
													<a href="/legacy-index.html">FAKE 4</a>
													<ul>
														<li><a href="/legacy-gettingstarted.html">Getting Started Tutorial</a></li>
														<li><a href="/help-docs.html">Where is XYZ???</a></li>
														<li><a href="/legacy-commandline.html">Running FAKE from command line</a></li>
														<li><a href="/legacy-core-targets.html">Targets</a></li>
													</ul>
												</li>
                                                <li >
                                                    <a href="/fake-gettingstarted.html">Tutorials</a>
                                                    <ul>
                                                        <li><a href="/fake-gettingstarted.html">Getting Started Tutorial</a></li>
                                                        <li><a href="/fake-cache.html">Build script caching</a></li>
                                                        <li><a href="/fake-commandline.html">Running FAKE from command line</a></li>
                                                        <li><a href="/fake-dotnetcore.html">FAKE 5 quickstart</a></li>
                                                        <li><a href="/fake-migrate-to-fake-5.html">FAKE 5 migration</a></li>
                                                        <li><a href="/fake-debugging.html">Debugging Scripts</a></li>
                                                    </ul>
                                                </li>
												<li >
													<a href="/fake-what-is-fake.html">Project</a>
													<ul>
														<li><a href="/help-users.html">Who is using FAKE?</a></li>
														<li><a href="/help-supporters.html">Supporters</a></li>
														<li><a href="https://www.nuget.org/packages/FAKE">NuGet</a></li>
														<li><a href="https://chocolatey.org/packages/fake">Chocolatey</a></li>
														<li><a href="https://github.com/fsharp/FAKE"><i style="font-size: 15px;" class="im im-github"></i> GitHub</a></li>
														<li><a href="https://github.com/fsharp/FAKE/blob/master/License.txt">License</a></li>
														<li><a href="/RELEASE_NOTES.html">Release Notes</a></li>
														<li><a href="/contributing.html">Contributing</a></li>
														<li><a href="https://github.com/fsharp/FAKE/issues/new"><i style="font-size: 15px;" class="im im-mail"></i> Ask a question or report a bug</a></li>
													</ul>
												</li>
												<li class="current_page_item">
													<a href="/fake-fake5-modules.html">Modules</a>
													<ul>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Api">API</a>
															<ul>
																<li><a href="/api-slack.html">Slack</a></li>
																<li><a href="/apidocs/v5/fake-api-github.html">GitHub</a></li>
																<li><a href="/apidocs/v5/fake-api-hockeyapp.html">HockeyApp</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Azure">Azure</a>
															<ul>
																<li><a href="/apidocs/v5/fake-azure-cloudservices.html">CloudServices</a></li>
																<li><a href="/apidocs/v5/fake-azure-emulators.html">Emulators</a></li>
																<li><a href="/apidocs/v5/fake-azure-kudu.html">Kudu</a></li>
																<li><a href="/apidocs/v5/fake-azure-webjobs.html">WebJobs</a></li>
															</ul>
														</li>
														<li>
															<a href="/buildserver.html">BuildServer</a>
															<ul>
																<li><a href="/apidocs/v5/index.html#Fake.BuildServer">Api-Reference</a></li>
															</ul>
														</li>
														<li>
															<a href="/core.html">Core</a>
															<ul>
																<li><a href="/core-targets.html">Targets</a></li>
																<li><a href="/apidocs/v5/fake-core-environment.html">Environment</a></li>
																<li><a href="/core-process.html">Process</a></li>
																<li><a href="/apidocs/v5/fake-core-string.html">String</a></li>
																<li><a href="/apidocs/v5/fake-core-buildserver.html">BuildServer</a></li>
																<li><a href="/core-trace.html">Trace</a></li>
																<li><a href="/core-commandlineparsing.html">CommandLineParsing</a></li>
																<li><a href="/apidocs/v5/fake-core-context.html">Context</a></li>
																<li><a href="/apidocs/v5/fake-core-xml.html">Xml</a></li>
																<li><a href="/apidocs/v5/fake-core-taskrunner.html">Tasks</a></li>
																<li><a href="/apidocs/v5/fake-core-releasenotes.html">ReleaseNotes</a></li>
																<li><a href="/apidocs/v5/fake-core-changelog.html">ChangeLog</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Documentation">Documentation</a>
															<ul>
																<li><a href="/apidocs/v5/fake-documentation-docfx.html">DocFx</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.DotNet">DotNet</a>
															<ul>
																<li><a href="/dotnet-cli.html">Cli</a></li>
																<li><a href="/dotnet-assemblyinfo.html">AssemblyInfoFile</a></li>
                                                                <li><a href="/apidocs/v5/fake-dotnet-fsc.html">Fsc</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-msbuild.html">MSBuild</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-testing-nunit3.html">Testing - NUnit</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-testing-mspec.html">Testing - MSpec</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-testing-xunit2.html">Testing - XUnit2</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-testing-expecto.html">Testing - Expecto</a></li>
																<li><a href="/fake-dotnet-testing-specflow.html">Testing - SpecFlow</a></li>
																<li><a href="/dotnet-testing-opencover.html">Testing - OpenCover</a></li>
																<li><a href="/dotnet-nuget.html">NuGet</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-mage.html">Mage</a></li>
																<li><a href="/apidocs/v5/fake-dotnet-paket.html">Paket</a></li>
															</ul>
														</li>
														<li>
															<a href="/core-targets.html">DSL</a>
															<ul>
																<li><a href="https://github.com/xakebuild/Xake">Xake</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/index.html#Fake.Installer">Installer</a>
															<ul>
																<li><a href="/apidocs/fake-installer-innosetup.html">InnoSetup</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/index.html#Fake.IO">IO</a>
															<ul>
																<li><a href="/apidocs/v5/index.html#Fake.IO">FileSystem</a></li>
																<li><a href="/apidocs/v5/fake-io-changewatcher.html">Change Watcher</a></li>
																<li><a href="/apidocs/v5/fake-io-globbing-operators.html">Globbing</a></li>
																<li><a href="/apidocs/v5/fake-io-zip.html#Functions and values">Zip</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.JavaScript">JavaScript</a>
															<ul>
																<li><a href="/apidocs/v5/fake-javascript-npm.html">Npm</a></li>
																<li><a href="/apidocs/v5/fake-javascript-yarn.html">Yarn</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Net">Net</a>
															<ul>
																<li><a href="/net-http.html">Http</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Sql">Sql</a>
															<ul>
																<li><a href="/sql-dacpac.html">DacPac</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Testing">Testing</a>
															<ul>
																<li><a href="/testing-sonarqube.html">SonarQube</a></li>
																<li><a href="/testing-reportgenerator.html">ReportGenerator</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Tools.Git">Tools</a>
															<ul>
																<li><a href="/apidocs/v5/index.html#Fake.Tools.Git">Git</a></li>
																<li><a href="/fake-tools-pickles.html">Pickles</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/index.html#Fake.Windows">Windows</a>
															<ul>
																<li><a href="/windows-chocolatey.html">Chocolatey</a></li>
															</ul>
                                                            <ul>
																<li><a href="/apidocs/v5/fake-windows-registry.html">Registry</a></li>
															</ul>
														</li>
														<li>
															<a href="/apidocs/v5/legacy/index.html#Fake">Legacy / Not Migrated</a>
															<ul>
																<li><a href="/todo-fluentmigrator.html">?.?.FluentMigrator</a></li>
																<li><a href="/todo-androidpublisher.html">?.?.AndroidPublisher</a></li>
																<li><a href="/todo-wix.html">Windows.WiX</a></li>
																<li><a href="/todo-msteamsnotification.html">API.MsTeams</a></li>
																<li><a href="/todo-stylecop.html">DotNet.StyleCop</a></li>
																<li><a href="/todo-deploy.html">Fake.Deploy</a></li>
																<li><a href="/todo-iis.html">?.?.IIS</a></li>
																<li><a href="/todo-vagrant.html">?.?.Vagrant</a></li>
																<li><a href="/todo-fxcop.html">DotNet.FxCop</a></li>
																<li><a href="/todo-canopy.html">DotNet.Testing.Canopy</a></li>
																<li><a href="/todo-octopusdeploy.html">?.?.OctopusDeploy</a></li>
																<li><a href="/todo-typescript.html">JavaScript?.TypeScript</a></li>
															</ul>
														</li>
													</ul>
												</li>
												<li >
                                                    <a href="/apidocs/v5/index.html">API Reference</a>
                                                    <ul>
														<li><a href="/apidocs/v5/index.html">FAKE 5 API Reference</a></li>
	                                                    <li><a href="/apidocs/v5/legacy/index.html">FAKE 5 Migration API</a></li>
	                                                    <li><a href="/apidocs/v4/index.html">FAKE 4 API Reference</a></li>
													</ul>
                                                </li>
											</ul>
										</nav>

								</div>
							</header>

						<!-- Banner -->
							

					</div>
				</div>

			<!-- Main Wrapper -->
				<div id="main-wrapper">
          			

					<div class="wrapper style2">
						<div class="inner">
							<div class="container">
								<div id="content">

									<!-- Content -->
                      <article>
<h1><a name="Create-WiX-Setup" class="anchor" href="#Create-WiX-Setup">Create WiX Setup</a></h1>
<p>If you often ship software to customers, it might be comfortable for you to install it using setups rather than manually deploying.
FAKE provides you with support for creating MSI setups using the WiX Toolset (<a href="http://wixtoolset.org/).">http://wixtoolset.org/).</a></p>
<h2><a name="Minimal-working-example" class="anchor" href="#Minimal-working-example">Minimal working example</a></h2>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
<span class="l">51: </span>
<span class="l">52: </span>
<span class="l">53: </span>
<span class="l">54: </span>
<span class="l">55: </span>
<span class="l">56: </span>
<span class="l">57: </span>
<span class="l">58: </span>
<span class="l">59: </span>
<span class="l">60: </span>
<span class="l">61: </span>
<span class="l">62: </span>
<span class="l">63: </span>
<span class="l">64: </span>
<span class="l">65: </span>
<span class="l">66: </span>
<span class="l">67: </span>
<span class="l">68: </span>
<span class="l">69: </span>
<span class="l">70: </span>
<span class="l">71: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Target</span> <span class="s">&quot;BuildWiXSetup&quot;</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">_</span> <span class="k">-&gt;</span>
    <span class="c">// This defines, which files should be collected when running bulkComponentCreation</span>
    <span class="k">let</span> <span class="id">fileFilter</span> <span class="o">=</span> <span class="k">fun</span> <span class="pn">(</span><span class="id">file</span> <span class="pn">:</span> <span class="id">FileInfo</span><span class="pn">)</span> <span class="k">-&gt;</span> 
        <span class="k">if</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.dll&quot;</span> <span class="o">||</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.exe&quot;</span> <span class="o">||</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.config&quot;</span> <span class="k">then</span> 
            <span class="k">true</span> 
        <span class="k">else</span> 
            <span class="k">false</span>
        
    <span class="c">// Collect Files which should be shipped. Pass directory with your deployment output for deployDir</span>
    <span class="c">// along with the targeted architecture.</span>
    
    <span class="k">let</span> <span class="id">components</span> <span class="o">=</span> <span class="id">bulkComponentCreation</span> <span class="id">fileFilter</span> <span class="pn">(</span><span class="id">DirectoryInfo</span> <span class="id">deployDir</span><span class="pn">)</span> <span class="id">Architecture</span><span class="pn">.</span><span class="id">X86</span>
             
    <span class="c">// Collect component references for usage in features</span>
    <span class="k">let</span> <span class="id">componentRefs</span> <span class="o">=</span> <span class="id">components</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">map</span><span class="pn">(</span><span class="k">fun</span> <span class="id">comp</span> <span class="k">-&gt;</span> <span class="id">comp</span><span class="pn">.</span><span class="id">ToComponentRef</span><span class="pn">(</span><span class="pn">)</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">completeFeature</span> <span class="o">=</span> <span class="id">generateFeatureElement</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span> 
                                                    <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>  
                                                        <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;Complete&quot;</span>
                                                        <span class="id">Title</span> <span class="o">=</span> <span class="s">&quot;Complete Feature&quot;</span>
                                                        <span class="id">Level</span> <span class="o">=</span> <span class="n">1</span> 
                                                        <span class="id">Description</span> <span class="o">=</span> <span class="s">&quot;Installs all features&quot;</span>
                                                        <span class="id">Components</span> <span class="o">=</span> <span class="id">componentRefs</span>
                                                        <span class="id">Display</span> <span class="o">=</span> <span class="id">Expand</span> 
                                                    <span class="pn">}</span><span class="pn">)</span>

    <span class="c">// Generates a predefined WiX template with placeholders which will be replaced in &quot;FillInWiXScript&quot;</span>
    <span class="id">generateWiXScript</span> <span class="s">&quot;SetupTemplate.wxs&quot;</span>

    <span class="k">let</span> <span class="id">WiXUIMondo</span> <span class="o">=</span> <span class="id">generateUIRef</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span>
                                        <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>
                                            <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;WixUI_Mondo&quot;</span>
                                        <span class="pn">}</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">WiXUIError</span> <span class="o">=</span> <span class="id">generateUIRef</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span>
                                        <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>
                                            <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;WixUI_ErrorProgressText&quot;</span>
                                        <span class="pn">}</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">MajorUpgrade</span> <span class="o">=</span> <span class="id">generateMajorUpgradeVersion</span><span class="pn">(</span>
                            <span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span>
                                <span class="pn">{</span><span class="id">f</span> <span class="k">with</span> 
                                    <span class="id">Schedule</span> <span class="o">=</span> <span class="id">MajorUpgradeSchedule</span><span class="pn">.</span><span class="id">AfterInstallExecute</span>
                                    <span class="id">DowngradeErrorMessage</span> <span class="o">=</span> <span class="s">&quot;A later version is already installed, exiting.&quot;</span>
                                <span class="pn">}</span><span class="pn">)</span>

    <span class="id">FillInWiXTemplate</span> <span class="s">&quot;&quot;</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span>
                            <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>
                                <span class="c">// Guid which should be generated on every build</span>
                                <span class="id">ProductCode</span> <span class="o">=</span> <span class="id">Guid</span><span class="pn">.</span><span class="id">NewGuid</span><span class="pn">(</span><span class="pn">)</span>
                                <span class="id">ProductName</span> <span class="o">=</span> <span class="s">&quot;Test Setup&quot;</span>
                                <span class="id">Description</span> <span class="o">=</span> <span class="s">&quot;Description of Test Setup&quot;</span>
                                <span class="id">ProductLanguage</span> <span class="o">=</span> <span class="n">1033</span>
                                <span class="id">ProductVersion</span> <span class="o">=</span> <span class="s">&quot;1.0.0&quot;</span>
                                <span class="id">ProductPublisher</span> <span class="o">=</span> <span class="s">&quot;YouOrYourCompany&quot;</span>
                                <span class="c">// Set fixed upgrade guid, this should never change for this project!</span>
                                <span class="id">UpgradeGuid</span> <span class="o">=</span> <span class="id">WixProductUpgradeGuid</span>
                                <span class="id">MajorUpgrade</span> <span class="o">=</span> <span class="pn">[</span><span class="id">MajorUpgrade</span><span class="pn">]</span>
                                <span class="id">UIRefs</span> <span class="o">=</span> <span class="pn">[</span><span class="id">WiXUIMondo</span><span class="pn">;</span> <span class="id">WiXUIError</span><span class="pn">]</span>
                                <span class="id">ProgramFilesFolder</span> <span class="o">=</span> <span class="id">ProgramFiles32</span>
                                <span class="id">Components</span> <span class="o">=</span> <span class="id">components</span>
                                <span class="id">BuildNumber</span> <span class="o">=</span> <span class="s">&quot;Build number&quot;</span>
                                <span class="id">Features</span> <span class="o">=</span> <span class="pn">[</span><span class="id">completeFeature</span><span class="pn">]</span>
                            <span class="pn">}</span><span class="pn">)</span>
        

    <span class="c">// run the WiX tools</span>
    <span class="id">WiX</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">p</span> <span class="k">-&gt;</span> <span class="pn">{</span><span class="id">p</span> <span class="k">with</span> <span class="id">ToolDirectory</span> <span class="o">=</span> <span class="id">WiXPath</span><span class="pn">}</span><span class="pn">)</span> 
        <span class="id">setupFileName</span>
        <span class="s">@&quot;.\SetupTemplate.wxs&quot;</span>
<span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Further-possibilities" class="anchor" href="#Further-possibilities">Further possibilities</a></h2>
<p>Besides just plainly shipping those files as setup you can also use the custom action and custom action execution elements to execute various commands before or after certain events during the installation.
This gives you the possibility to for example install, uninstall, start or stop certain services when you need to.
If your software is for example running as a service at your customer's side, you would need to manually stop and start the services on upgrades.
WiX knows the "ServiceControl" element for starting, stopping and removing services. You attach it to components.
If a component's files change and it has a Service Control element, the service that is referred to will be started, stopped or uninstalled, just as you defined it.
You can use the attachServiceToControlComponents function for attaching service controls to components. You would only have to slightly change the above example:</p>
<h3><a name="Example" class="anchor" href="#Example">Example</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">serviceControl</span> <span class="o">=</span> <span class="id">generateServiceControl</span><span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span> <span class="pn">{</span><span class="id">f</span> <span class="k">with</span> 
                                                        <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;PickAnId&quot;</span>
                                                        <span class="id">Name</span> <span class="o">=</span> <span class="s">&quot;QualifiedNameOfYourService&quot;</span>
                                                        <span class="id">Start</span> <span class="o">=</span> <span class="id">InstallUninstall</span><span class="pn">.</span><span class="id">Install</span>
                                                        <span class="id">Stop</span> <span class="o">=</span> <span class="id">InstallUninstall</span><span class="pn">.</span><span class="id">Both</span>
                                                        <span class="id">Remove</span> <span class="o">=</span> <span class="id">InstallUninstall</span><span class="pn">.</span><span class="id">Uninstall</span><span class="pn">}</span><span class="pn">)</span>

<span class="c">// This defines, that all executable files should be tagged with the service control element</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="fn">componentSelector</span> <span class="o">=</span> <span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="id">comp</span> <span class="pn">:</span> <span class="id">WiXComponent</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="id">comp</span><span class="pn">.</span><span class="id">Files</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs1', 7)" onmouseover="showTip(event, 'fs1', 7)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="id">exists</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="id">file</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="id">file</span><span class="pn">.</span><span class="id">Name</span><span class="pn">.</span><span class="id">EndsWith</span><span class="pn">(</span><span class="s">&quot;.exe&quot;</span><span class="pn">)</span><span class="pn">)</span> 

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="id">components</span> <span class="o">=</span> <span class="id">attachServiceControlToComponents</span>
                    <span class="pn">(</span><span class="id">bulkComponentCreation</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">file</span> <span class="k">-&gt;</span> 
                        <span class="k">if</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.dll&quot;</span> <span class="o">||</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.exe&quot;</span> <span class="o">||</span> <span class="id">file</span><span class="pn">.</span><span class="id">Extension</span> <span class="o">=</span> <span class="s">&quot;.config&quot;</span> <span class="k">then</span> 
                            <span class="k">true</span> 
                        <span class="k">else</span> 
                            <span class="k">false</span><span class="pn">)</span> <span class="pn">(</span><span class="id">DirectoryInfo</span> <span class="id">deployDir</span><span class="pn">)</span><span class="pn">)</span>
                    <span onmouseout="hideTip(event, 'fs4', 12)" onmouseover="showTip(event, 'fs4', 12)" class="id">componentSelector</span> 
                    <span class="pn">[</span><span onmouseout="hideTip(event, 'fs3', 13)" onmouseover="showTip(event, 'fs3', 13)" class="id">serviceControl</span><span class="pn">]</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Registry" class="anchor" href="#Registry">Registry</a></h2>
<p>If you need your installer to modify the registry, you can achieve this by creating a component containing <code>RegistryKey</code> and <code>RegistryValue</code> elements. A <code>RegistryKey</code> can have further keys and values nested as children.</p>
<h3><a name="Example-1" class="anchor" href="#Example-1">Example</a></h3>
<p>First, define the desired registry layout and add it to a new component:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 14)" onmouseover="showTip(event, 'fs9', 14)" class="id">registryDefinition</span> <span class="o">=</span> <span class="id">generateRegistryKey</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span> <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>
                                                          <span class="id">Root</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 15)" onmouseover="showTip(event, 'fs10', 15)" class="id">Some</span> <span class="id">WiXRegistryRootType</span><span class="pn">.</span><span class="id">HKCU</span>
                                                          <span class="id">Key</span> <span class="o">=</span> <span class="s">&quot;Some key name&quot;</span>
                                                          <span class="id">Values</span> <span class="o">=</span> <span class="pn">[</span>
                                                            <span class="id">generateRegistryValue</span><span class="pn">(</span><span class="k">fun</span> <span class="id">v</span> <span class="k">-&gt;</span> 
                                                                                    <span class="pn">{</span><span class="id">v</span> <span class="k">with</span>
                                                                                       <span class="id">Name</span> <span class="o">=</span> <span class="s">&quot;Something&quot;</span>
                                                                                       <span class="id">Type</span> <span class="o">=</span> <span class="id">WiXRegistryValueType</span><span class="pn">.</span><span class="id">Integer</span>
                                                                                       <span class="id">Value</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span>
                                                                                    <span class="pn">}</span><span class="pn">)</span>
                                                          <span class="pn">]</span>
                                                          <span class="id">Keys</span> <span class="o">=</span> <span class="pn">[</span>
                                                            <span class="c">//Could nest more keys here</span>
                                                          <span class="pn">]</span>
                                                       <span class="pn">}</span><span class="pn">)</span>
                                                      
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 16)" onmouseover="showTip(event, 'fs11', 16)" class="id">regComponent</span> <span class="o">=</span> <span class="id">C</span> <span class="pn">(</span><span class="id">generateComponent</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">c</span> <span class="k">-&gt;</span> <span class="pn">{</span><span class="id">c</span> <span class="k">with</span>
                                                     <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;RegistryEntries&quot;</span>
                                                     <span class="id">RegistryKeys</span> <span class="o">=</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs9', 17)" onmouseover="showTip(event, 'fs9', 17)" class="id">registryDefinition</span><span class="pn">]</span>
                                                  <span class="pn">}</span><span class="pn">)</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>This component needs to be attached to the <code>TARGETDIR</code> directory. This effectively means the registry entries should be installed to the target user's machine. For this we will use a <code>DirectoryRef</code> pointing to <code>TARGETDIR</code>.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 18)" onmouseover="showTip(event, 'fs12', 18)" class="id">targetDirRef</span> <span class="o">=</span> <span class="id">generateDirectoryRef</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">r</span> <span class="k">-&gt;</span> <span class="pn">{</span><span class="id">r</span> <span class="k">with</span>
                                                     <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;TARGETDIR&quot;</span>
                                                     <span class="id">Components</span> <span class="o">=</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="id">regComponent</span><span class="pn">]</span>
                                                  <span class="pn">}</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>The directory reference should be included in the <code>DirectoryRefs</code> sequence when calling <code>FillInWixTemplate</code>, and a reference to <code>regComponent</code> should be added to the relevant feature.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="id">componentRefs</span> <span class="o">=</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs1', 21)" onmouseover="showTip(event, 'fs1', 21)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="id">append</span> <span onmouseout="hideTip(event, 'fs8', 23)" onmouseover="showTip(event, 'fs8', 23)" class="id">components</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs11', 24)" onmouseover="showTip(event, 'fs11', 24)" class="id">regComponent</span><span class="pn">]</span><span class="pn">)</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs1', 25)" onmouseover="showTip(event, 'fs1', 25)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 26)" onmouseover="showTip(event, 'fs2', 26)" class="id">map</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs15', 27)" onmouseover="showTip(event, 'fs15', 27)" class="id">comp</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="id">comp</span><span class="pn">.</span><span class="id">ToComponentRef</span><span class="pn">(</span><span class="pn">)</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="id">completeFeature</span> <span class="o">=</span> <span class="id">generateFeatureElement</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span> 
                                                <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>  
                                                    <span class="id">Id</span> <span class="o">=</span> <span class="s">&quot;Complete&quot;</span>
                                                    <span class="id">Title</span> <span class="o">=</span> <span class="s">&quot;Complete Feature&quot;</span>
                                                    <span class="id">Level</span> <span class="o">=</span> <span class="n">1</span> 
                                                    <span class="id">Description</span> <span class="o">=</span> <span class="s">&quot;Installs all features&quot;</span>
                                                    <span class="id">Components</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 30)" onmouseover="showTip(event, 'fs13', 30)" class="id">componentRefs</span>
                                                    <span class="id">Display</span> <span class="o">=</span> <span class="id">Expand</span> 
                                                <span class="pn">}</span><span class="pn">)</span>

<span class="id">FillInWiXTemplate</span> <span class="s">&quot;&quot;</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">f</span> <span class="k">-&gt;</span>
                        <span class="pn">{</span><span class="id">f</span> <span class="k">with</span>
                            <span class="c">// Guid which should be generated on every build</span>
                            <span class="id">ProductCode</span> <span class="o">=</span> <span class="id">Guid</span><span class="pn">.</span><span class="id">NewGuid</span><span class="pn">(</span><span class="pn">)</span>
                            <span class="id">ProductName</span> <span class="o">=</span> <span class="s">&quot;Test Setup&quot;</span>
                            <span class="id">Description</span> <span class="o">=</span> <span class="s">&quot;Description of Test Setup&quot;</span>
                            <span class="id">ProductLanguage</span> <span class="o">=</span> <span class="n">1033</span>
                            <span class="id">ProductVersion</span> <span class="o">=</span> <span class="s">&quot;1.0.0&quot;</span>
                            <span class="id">ProductPublisher</span> <span class="o">=</span> <span class="s">&quot;YouOrYourCompany&quot;</span>
                            <span class="c">// Set fixed upgrade guid, this should never change for this project!</span>
                            <span class="id">UpgradeGuid</span> <span class="o">=</span> <span class="id">WixProductUpgradeGuid</span>
                            <span class="id">MajorUpgrade</span> <span class="o">=</span> <span class="pn">[</span><span class="id">MajorUpgrade</span><span class="pn">]</span>
                            <span class="id">UIRefs</span> <span class="o">=</span> <span class="pn">[</span><span class="id">WiXUIMondo</span><span class="pn">;</span> <span class="id">WiXUIError</span><span class="pn">]</span>
                            <span class="id">ProgramFilesFolder</span> <span class="o">=</span> <span class="id">ProgramFiles32</span>
                            <span class="id">Components</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 31)" onmouseover="showTip(event, 'fs8', 31)" class="id">components</span>
                            <span class="id">BuildNumber</span> <span class="o">=</span> <span class="s">&quot;Build number&quot;</span>
                            <span class="id">Features</span> <span class="o">=</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs16', 32)" onmouseover="showTip(event, 'fs16', 32)" class="id">completeFeature</span><span class="pn">]</span>
                            <span class="id">DirectoryRefs</span> <span class="o">=</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs12', 33)" onmouseover="showTip(event, 'fs12', 33)" class="id">targetDirRef</span><span class="pn">]</span>
                        <span class="pn">}</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs2">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;</div>
<div class="tip" id="fs3">val serviceControl : obj</div>
<div class="tip" id="fs4">val componentSelector : comp:&#39;a -&gt; bool</div>
<div class="tip" id="fs5">val comp : &#39;a</div>
<div class="tip" id="fs6">val exists : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; bool</div>
<div class="tip" id="fs7">val file : obj</div>
<div class="tip" id="fs8">val components : seq&lt;obj&gt;</div>
<div class="tip" id="fs9">val registryDefinition : obj</div>
<div class="tip" id="fs10">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs11">val regComponent : obj</div>
<div class="tip" id="fs12">val targetDirRef : obj</div>
<div class="tip" id="fs13">val componentRefs : seq&lt;obj&gt;</div>
<div class="tip" id="fs14">val append : source1:seq&lt;&#39;T&gt; -&gt; source2:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;</div>
<div class="tip" id="fs15">val comp : obj</div>
<div class="tip" id="fs16">val completeFeature : obj</div>

                      </article>
								</div>
							</div>
						</div>
					</div>

				</div>

			<!-- Footer Wrapper -->
				<div id="footer-wrapper">
					<footer id="footer" class="container">
						<div class="row">
							<div class="3u 12u(mobile)">

								<!-- Links -->
									<section>
										<h2>Important Links</h2>
										<ul class="divided">
											<li><a href="/fake-gettingstarted.html">Getting started</a></li>
											<li><a href="/fake-fake5-modules.html">Modules</a></li>
											<li><a href="/fake-fake5-modules.html#Declaring-FAKE-5-Header">FAKE Header</a></li>
										</ul>
									</section>

							</div>
							<div class="3u 12u(mobile)">

								<!-- Links -->
									<section>
										<h2>Further projects</h2>
										<ul class="divided">
											<li><a href="https://fsprojects.github.io/Paket/">Paket</a></li>
											<li><a href="https://fsprojects.github.io/FSharp.Formatting/">FSharp Formatting</a></li>
											<li><a href="http://fsharp.org/">F#</a></li>
											<li><a href="http://ionide.io/">Ionide</a></li>
											<li><a href="http://forge.run/">Forge</a></li>
											<li><a href="https://fsharp.github.io/FSharp.Compiler.Service/">FSharp.Compiler.Service</a></li>
										</ul>
									</section>

								<!-- Links
									<section>
										<h2>Learn F#</h2>
										<ul class="divided">
											<li><a href="/404.html">Tutorial 1</a></li>
											<li><a href="/404.html">Tutorial 2</a></li>
											<li><a href="/404.html">Tutorial 3</a></li>
											<li><a href="/404.html">Tutorial 4</a></li>
										</ul>
									</section>-->

							</div>
							<div class="6u 12u(mobile)">

								<!-- About -->
									<section>
										<h2><strong>FAKE 5</strong> is a community effort.</h2>
										<p>Please help with the development of <strong>FAKE 5</strong>, a free, fully open source
										DSL and Runtime for running F# scripts. Look at the open issues at <a href="https://github.com/fsharp/FAKE/issues">Github</a>,
                                        discuss new features, fix bugs and send pull requests!</p>
										<a href="/contributing.html" class="button alt icon fa-arrow-circle-right">Learn More</a>
									</section>

								<!-- Contact -->
									<section>
										<h2>Get in touch</h2>
										<div>
											<div class="row">
												<div class="6u 12u(mobile)">
													<dl class="contact">
														<dt>Twitter</dt>
														<dd><a href="https://twitter.com/fsharpMake">@fsharpMake</a></dd>
														<dt>WWW</dt>
														<dd><a href="https://fake.build">fake.build</a></dd>
														<dt>Github</dt>
														<dd><a href="https://github.com/fsharp/FAKE/issues/new">Github</a></dd>
														<dt>F# Slack</dt>
														<dd><a href="https://fsharp.slack.com/">Slack</a></dd>
													</dl>
												</div>
												<!--<div class="6u 12u(mobile)">
													<dl class="contact">
														<dt>Address</dt>
														<dd>
															1234 Fictional Rd<br />
															Nashville, TN 00000-0000<br />
															USA
														</dd>
														<dt>Phone</dt>
														<dd>(000) 000-0000</dd>
													</dl>
												</div>-->
											</div>
										</div>
									</section>

							</div>
						</div>
						<div class="row">
							<div class="12u">
								<div id="copyright">
									<ul class="menu">
										<li>&copy; FAKE. All rights reserved</li>
										<li>Design: <a href="https://html5up.net">HTML5 UP</a></li>
										<li>Page generated with Version: <a href="https://github.com/fsharp/FAKE/releases">5.0.0-rc017.237</a></li>
									</ul>
								</div>
							</div>
						</div>
					</footer>
				</div>

		</div>

		<!-- Scripts -->
			<!--<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>-->
			<script src="/assets/js/tips.js" type="text/javascript"></script>
			<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.dropotron.min.js"></script>
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/skel-viewport.min.js"></script>
			<script src="/assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="/assets/js/main.js"></script>
                  
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-fsharp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-batch.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/plugins/toolbar/prism-toolbar.js"></script>

        <script src="/assets/js/clipboardTooltip.js"></script>
	</body>
	</body>
</html>
